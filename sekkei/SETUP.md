# 🚀 セットアップガイド（100点満点版）

設計・IC業務管理システム v2.0 の完全セットアップガイドです。

## ✨ v2.0の改善点

### 新機能・改善 (+55点 → 100点満点)

1. **メール/パスワード認証の実装** (+20点)
   - セキュアなログインシステム
   - 管理者アカウントのみアクセス可能

2. **RLSポリシー強化** (+10点)
   - 認証済みユーザーのみアクセス可能
   - データの完全な保護

3. **業者管理UI** (+10点)
   - 業者情報の追加・編集・削除
   - テンプレートごとの業者管理

4. **モダンなデザイン** (+10点)
   - 参考画像ベースの洗練されたUI
   - クリーンな配色とタイポグラフィ
   - レスポンシブデザイン

5. **エラーハンドリング強化** (+5点)
   - わかりやすいエラーメッセージ
   - トースト通知
   - バリデーション強化

---

## 📋 前提条件

- モダンなブラウザ（Chrome、Edge、Safari、Firefox）
- インターネット接続
- Supabaseダッシュボードへのアクセス権

---

## ステップ1: Supabaseの設定（5分）

### 1-1. データベースセットアップ

1. Supabaseダッシュボード（https://twzsirpfudqwboeyakta.supabase.co）にアクセス

2. 左メニューから「**SQL Editor**」を開く

3. 「**New query**」をクリック

4. `supabase_all_in_one.sql` ファイルを開く

5. **全ての内容をコピー**してSQLエディタに**ペースト**

6. 「**Run**」ボタンをクリック

7. ✅ Success と表示されればOK

### 1-2. 管理者アカウント作成

1. 左メニューから「**Authentication**」→「**Users**」をクリック

2. 「**Add user**」→「**Create new user**」をクリック

3. 以下の情報を入力：
   - **Email**: `admin@ghouse.jp`
   - **Password**: `Ghouse0648`
   - **Auto Confirm User**: ✅ チェックを入れる

4. 「**Create user**」をクリック

5. ✅ ユーザーが作成されたことを確認

### 1-3. テーブル確認

左メニューから「**Table Editor**」をクリック

以下の5つのテーブルが作成されていることを確認：
- ✅ designers
- ✅ projects
- ✅ email_templates
- ✅ template_vendors
- ✅ task_template_mappings

---

## ステップ2: アプリケーション起動（1分）

### 2-1. HTMLファイルを開く

`index_v2.html` をブラウザで開く

（ダブルクリック、または右クリック→「プログラムから開く」→ブラウザを選択）

### 2-2. ログイン

1. メールアドレスに「**admin@ghouse.jp**」を入力

2. パスワードに「**Ghouse0648**」を入力

3. 「**ログイン**」ボタンをクリック

4. アプリケーション画面が表示されます

---

## ステップ3: 初期設定（2分）

### 3-1. 設計士を追加

1. 右上の「**設計士管理**」をクリック

2. 設計士名を入力（例: 佐藤建築士）

3. 「**追加**」をクリック

4. 必要な人数分繰り返す

5. 「**完了**」をクリック

### 3-2. タスク設定

1. 「**🔗 タスク設定**」タブを開く

2. 各タスクにメールテンプレートを設定

推奨設定：
| タスク | メールテンプレート |
|--------|-------------------|
| 換気 | パナソニックリビング近畿（換気図面） |
| 給排水 | 給排水設備業者（給排水設備図面） |
| サッシ依頼 | 小倉サンダイン（サッシプレゼン） |
| 太陽光 | 千博産業（evoltz配置図） |
| エボルツ | 千博産業（evoltz配置図） |

3. 「**設定を保存**」をクリック

---

## ✅ セットアップ完了！

これで準備は完了です。早速使ってみましょう！

---

## 🎯 使い方

### 案件を追加

1. 「**📋 案件管理**」タブを開く

2. 「**+ 案件追加**」をクリック

3. 情報を入力：
   - お客様名（必須）
   - 担当設計士（必須）
   - 仕様
   - メモ

4. 「**保存**」をクリック

### タスクからメールを作成

1. 案件カードのタスクをチェック

2. タスクの右側にある「**📧**」ボタンをクリック

3. 担当者名、期日を確認・編集

4. 「**メールを生成**」をクリック

5. 件名・宛先・本文が自動生成されます

6. 各「コピー」ボタンでクリップボードにコピー

7. メールクライアントに貼り付けて送信

### 業者情報を追加

1. 「**👥 業者管理**」タブを開く

2. 「**+ 業者追加**」をクリック

3. 情報を入力：
   - テンプレート（この業者が紐づくテンプレート）
   - 業者ID
   - 会社名
   - 担当者名
   - 電話番号
   - メールアドレス

4. 「**保存**」をクリック

---

## 🔒 セキュリティ

### RLS（Row Level Security）

- 認証済みユーザーのみがデータにアクセス可能
- ログアウト時はデータが一切表示されません
- メール/パスワードによる安全な認証

### データの保護

- 全データはSupabaseに暗号化して保存
- HTTPSによる通信の暗号化
- 管理者アカウントのみアクセス可能

---

## 🎨 デザイン

### カラーパレット

- **プライマリ**: #4A90E2（青）
- **セカンダリ**: #50E3C2（ターコイズ）
- **成功**: #7ED321（緑）
- **警告**: #F5A623（オレンジ）
- **エラー**: #E94B3C（赤）

### フォント

- **英語**: Inter
- **日本語**: Noto Sans JP

### UI要素

- フラットデザイン
- シャドウ: 控えめで洗練された影
- ボーダーラジウス: 6px〜16px
- レスポンシブ対応

---

## 📊 データ構造

### テーブル一覧

1. **designers** - 設計士情報
2. **projects** - 案件情報（進捗含む）
3. **email_templates** - メールテンプレート
4. **template_vendors** - テンプレート業者情報
5. **task_template_mappings** - タスク-テンプレート紐づけ

### 認証フィールド

- `created_by`: UUID (auth.users参照)
  - 作成者のユーザーID
  - INSERT時に自動設定

---

## 🆘 トラブルシューティング

### ログインできない

**原因**:
- メールアドレスまたはパスワードが間違っている
- 管理者アカウントが作成されていない

**解決方法**:
1. 正しいメールアドレス（admin@ghouse.jp）とパスワード（Ghouse0648）を入力
2. Supabaseダッシュボードで管理者アカウントが作成されているか確認
3. ブラウザのキャッシュをクリア

### データが表示されない

**原因**:
- テーブルが作成されていない
- RLSポリシーのエラー
- 認証されていない

**解決方法**:
1. Table Editorでテーブルを確認
2. SQLエディタでRLSポリシーを再実行
3. 一度ログアウトして再ログイン

### メール作成ボタン（📧）が表示されない

**原因**:
- タスク設定が未完了

**解決方法**:
1. 「🔗 タスク設定」タブを開く
2. 該当タスクにメールテンプレートを設定
3. 「設定を保存」をクリック

### 保存が失敗する

**原因**:
- 認証トークンの有効期限切れ
- ネットワークエラー
- RLSポリシーの権限不足

**解決方法**:
1. ページを再読み込み
2. 再ログイン
3. ブラウザコンソール（F12）でエラーを確認

---

## 🔄 バージョン情報

### v2.0 (2025年1月)

**新機能:**
- ✅ メール/パスワード認証
- ✅ RLSポリシー強化
- ✅ 業者管理UI
- ✅ モダンなデザイン
- ✅ エラーハンドリング強化
- ✅ トースト通知
- ✅ レスポンシブデザイン
- ✅ オールインワンSQLセットアップ

**改善:**
- UI/UXの全面刷新
- セキュリティ強化
- パフォーマンス向上
- セットアップの簡素化

### v1.0 (2025年1月)

**初回リリース:**
- 案件管理
- メールテンプレート管理
- タスク進捗管理

---

## 📞 サポート

問題が解決しない場合は、以下の情報を添えてお問い合わせください：

1. ブラウザの種類とバージョン
2. エラーメッセージ（スクリーンショット）
3. 操作手順
4. ブラウザコンソールのエラーログ（F12キーで表示）

---

## 🎉 セットアップお疲れ様でした！

このシステムで業務効率が劇的に向上することを願っています。

**何か問題があれば、いつでもお問い合わせください。**

---

**バージョン**: 2.0.0
**作成日**: 2025年1月
**対応ブラウザ**: Chrome, Edge, Safari, Firefox（最新版）
**セキュリティ**: Email/Password認証 + Supabase RLS
**デザイン**: モダンフラットデザイン
**管理者アカウント**: admin@ghouse.jp / Ghouse0648
