# データベース確認・修正手順

## 問題
コンソールエラー「データベースに接続されていません」が発生している可能性があります。

## 原因
`tasks`テーブルにデータが入っていない可能性があります。

---

## 手順1: テーブル確認

1. https://supabase.com/dashboard → あなたのプロジェクト
2. 左メニュー「SQL Editor」をクリック
3. 「New query」をクリック
4. `C:\claudecode\nandemo\sekkei\check_tables.sql` の内容を全てコピー&ペースト
5. 「Run」をクリック

### 期待される結果

```
table_name                  | record_count
----------------------------|-------------
vendor_categories           | 9
tasks                       | 24
vendors_v2                  | ?
task_vendor_mappings_v2     | ?
```

---

## 手順2-A: tasksが0件の場合（タスクデータ投入）

1. https://supabase.com/dashboard → あなたのプロジェクト
2. 左メニュー「SQL Editor」をクリック
3. 「New query」をクリック
4. `C:\claudecode\nandemo\sekkei\insert_tasks_simple.sql` の内容を全てコピー&ペースト
5. 「Run」をクリック
6. 実行結果で「✅ タスクデータ投入完了」と表示されることを確認

### 投入されるタスク
- 設計用: 16個（0回目打合せ、見積、契約、構造依頼、換気図面、給排水、サッシ、太陽光、エボルツ、確認申請など）
- IC用: 8個（打合せ、見積、契約、設備PB、ファブレス、照明プラン、建具プレゼン、アイアン階段手摺）

---

## 手順2-B: vendor_categoriesが0件の場合（カテゴリデータ投入）

create_new_tables.sqlを実行していない場合：

1. https://supabase.com/dashboard → あなたのプロジェクト
2. 左メニュー「SQL Editor」をクリック
3. 「New query」をクリック
4. `C:\claudecode\nandemo\sekkei\create_new_tables.sql` の内容を全てコピー&ペースト
5. 「Run」をクリック

---

## 手順3: ブラウザをリロード

全て完了したら：

1. https://nandemo-h1vbxj71z-ghouse-developments-projects.vercel.app/sekkei/index_v2.html
2. F5キーでリロード
3. F12キーでDevToolsを開く
4. Consoleタブで以下を確認：
   - `✅ タスク読み込み完了: XX件`
   - エラーがないこと

---

## 手順4: 動作確認

1. ログイン（admin@ghouse.jp）
2. 「📋 案件管理」タブ
   - 既存案件のタスクが表示されることを確認
3. 「✅ タスク管理」タブをクリック
   - 設計タスク16件、ICタスク8件が表示されることを確認
4. 「🏷️ カテゴリ管理」タブをクリック
   - 9種類のカテゴリが表示されることを確認

---

## トラブルシューティング

### エラー: relation "tasks" does not exist

→ `create_new_tables.sql`を実行してください

### タスクが表示されない

→ `insert_tasks_simple.sql`を実行してください

### コンソールエラー: "tasksV2テーブルにデータがありません"

→ `insert_tasks_simple.sql`を実行後、ブラウザをリロードしてください
